# Найд по настройке Orange PI 3B

У Orange Pi 3B нет встроенной постоянной памяти, поэтому операционную систему (ОС) необходимо загружать либо на microSD-карту, либо на модуль eMMC.

---

## Шаг 1. Подготовка носителя с операционной системой

1. **Скачайте образ ОС** с официального сайта Orange Pi. В данном примере рассмотрена Ubuntu 22.  
2. **Запишите образ** на microSD-карту через BalenaEtcher или другую удобную программу.  
   - Если вы планируете установку на eMMC, нужно следовать официальному гиду от Orange Pi и использовать рекомендуемые инструменты (обычно они на китайском, но порядок действий там типовой).  
3. **Убедитесь, что запись прошла успешно** – программа должна сообщить об успешном окончании процесса.

**Совет**: при возникновении сомнений проверьте контрольную сумму (checksum) образа ОС, чтобы исключить повреждения файла.

---

## Шаг 2. Первичное подключение

1. Вставьте microSD-карту (или подготовленный eMMC-модуль) в Orange Pi 3B.
2. Подключите плату к монитору или телевизору через HDMI.
3. Подключите кабель Ethernet к маршрутизатору или коммутатору для сетевого доступа в Интернет.
4. Подайте питание на плату (через соответствующий блок питания).

При удачной загрузке вы увидите рабочий стол (если образ с графическим интерфейсом) или сможете войти в систему через терминал.

---

## Шаг 3. Подключение к Wi-Fi (при необходимости)

Если планируете работать по беспроводной сети:

1. Убедитесь, что модуль Wi-Fi включён:

   ```bash
   nmcli r wifi on
   ```

2. Просмотрите список доступных сетей:

   ```bash
   nmcli d wifi list
   ```

3. Подключитесь к нужной точке доступа (замените `<wifi_name>` и `<wifi_password>` на ваши):

   ```bash
   nmcli d wifi connect <wifi_name> password <wifi_password>
   ```

4. Для проверки подключения выполните:

   ```bash
   ping google.com
   ```

После этого устройство будет доступно в локальной сети по Wi-Fi.  

---

## Шаг 4. Подключение по SSH

1. Узнайте IP-адрес Orange Pi, используя `ifconfig` или `ip addr` (или же смотрите настройки роутера).  
2. С компьютера в этой же сети выполните (учтите, что стандартный пользователь и пароль — `orangepi`/`orangepi`):

   ```bash
   ssh orangepi@<ip_адрес>
   ```

3. Пароль по умолчанию: **orangepi** (замените при первом же входе).

---

## Шаг 5. Создание нового пользователя и обновление системы

Работать под дефолтной учётной записью не рекомендуется по соображениям безопасности. Создадим нового пользователя и отключим доступ для «orangepi»:

```bash
# Обновляем систему:
sudo apt update && sudo apt upgrade -y

# Создаём нового пользователя (замените <new_user_name> на ваше имя пользователя):
sudo adduser <new_user_name>

# Добавляем его в sudo-группу:
sudo usermod -aG sudo <new_user_name>

# Блокируем доступ для стандартного пользователя "orangepi"
sudo usermod -L orangepi
```

---

## Шаг 6. Дополнительная настройка безопасности (SSH)

1. Создайте/откройте файл настроек SSH:

   ```bash
   sudo nano /etc/ssh/sshd_config.d/10-custom.conf
   ```

2. Укажите кастомные параметры (пример):

   ```bash
   Port 7999                # Задаём нестандартный порт (пример: 7999)
   AllowUsers <new_user_name>  # Разрешаем вход только новому пользователю
   PermitRootLogin no       # Отключаем вход под root (если не нужен)
   ```

3. Примените изменения:

   ```bash
   sudo systemctl restart ssh
   sudo systemctl status ssh
   ```

**Важно**: Если меняете SSH-порт на удалённом сервере, не забудьте открыть новый порт в брандмауэре и сразу же переподключиться по новому порту.

---

## Шаг 7. Настройка брандмауэра (UFW)

```bash
sudo apt install ufw -y

sudo ufw default deny incoming
sudo ufw default allow outgoing

# Разрешаем соединения на новый порт SSH (пример: 7999)
sudo ufw allow 7999/tcp

# Если вы всё ещё пользуетесь стандартным портом SSH (22) или
# понадобятся исходящие соединения по SSH:
sudo ufw allow ssh
sudo ufw allow out ssh

# Включаем логирование и активируем UFW
sudo ufw logging on
sudo ufw enable

# Проверяем статус
sudo ufw status verbose
```

---

## Шаг 8. Установка и базовая настройка Docker (необязательно)

1. Создайте группу docker (если она ещё не существует):

   ```bash
   sudo groupadd docker
   ```

2. Добавьте вашего пользователя в эту группу:

   ```bash
   sudo usermod -aG docker $USER
   ```

3. Чтобы изменения вступили в силу, выйдите и зайдите снова или выполните:

   ```bash
   newgrp docker
   ```

---

## Шаг 9. Тонкости при использовании мобильного интернета

1. Для стабильного подключения по сотовым сетям (тетеринг через телефон и т.д.) нередко нужно увеличить `TTL`:

   ```bash
   sudo sysctl -w net.ipv4.ip_default_ttl=65
   ```

2. При запуске контейнеров Docker может потребоваться работа в режиме хост-сети:

   ```bash
   docker run --network host ...
   ```

---

## Шаг 10. Настройка часового пояса и базовые системные команды

1. Установите нужный часовой пояс, например, Европейская часть России:

   ```bash
   sudo timedatectl set-timezone Europe/Moscow
   ```

2. Проверьте результат:

   ```bash
   date
   timedatectl
   ```

3. Другие полезные команды:

   ```bash
   # Проверить свободное место
   df -h

   # Перезагрузить систему
   sudo reboot
   ```

---

## Заключение

Теперь ваша Orange Pi 3B настроена для работы по Ethernet или Wi-Fi, имеет безопасный SSH-доступ под новым пользователем и базовую защиту при помощи UFW.

Подобные одноплатные компьютеры демонстрируют, насколько мобильные процессоры становятся всё более универсальными. Уже сейчас можно брать небольшую плату с собой и разворачивать рабочее окружение где угодно — достаточно подключить питание и доступ к сети. Мне искренне импонирует мысль, что я могу положить одноплатник в кармат и разверуть окружение практически где угодно (при доступе к сети и интернету).
